# 24oss

# top
- top 명령어는 리눅스 시스템의 CPU 사용량, 메모리 사용량 등 전반적인 상황을 실시간으로 모니터링 할 수 있는 명령어

## 요약 영역
![Untitled](https://prod-files-secure.s3.us-west-2.amazonaws.com/5cad6622-460b-41ea-894f-850fbd49974c/030fe9eb-ae79-4244-adce-4883704e7dff/Untitled.png)

- 프로세스가 OS에 대해 리소스를 차지하는 정도 표시
- 시스템 시간(System time)
    - 시스템 현재 시간
    - == date 명령어
- Uptime
    - 시스템 구동 시간
- 유저 세션 수
    - 현재 시스템에 연결 된 사용자 수
- 로드 에버리지(Load Average)
    - 1분, 5분 15분 에 대한 평균 시스템 부하 수치
    - 부하: 해당 시간의 Running 혹은 D 상태인 uninterruptable sleep, I/O작업대기인 프로세스의 개수.
    - 멀티코어의 경우:  CPU 코어의 개수/로드에버리지
- Tasks
    - 현재 프로세스들의 상태 출력
- CPU 사용량
    - %CPU(s)는 CPU 사용률 출력. 총합: 100%
    - us : 유저 영역에서 CPU 사용률
    - sy : 커널 영역에서 CPU 사용률
    - ni : 프로세스 우선순위 설정에 사용되는 CPU 사용률
    - si : 소프트웨어 인터럽트를 관리하는 데 걸리는 시간의 백분율
    - id : 사용하지 않는 PCU 비율
    - wa : I/O 대기 상태의 CPU 사용률
    - hi : 하드웨어 인터럽트에 사용되는 CPU 사용률
    - st : Hypervisor VM 에서 사용해 대기하는 CPU 비율
- 메모리 사용량
    - MiB Mem : RAM의 정보 출력
    - MIB Swap : 디스크를 메모리처럼 사용하는 Swap 메모리 영역의 정보 출력
    - total : 총 메모리 양
    - free : 사용 가능한 메모리 양
    - used : 사용 중인 메모리양
    - buff/cache : 커널 버퍼와 디스크의 페이지 캐시에 사용되는 메모리 양. I/O에 사용되는 버퍼 메모리

## 디테일 영역

- PID : 프로세스 ID
- USER : 프로세스를 시작한 유효한 사용자의 ID
- PR : Scheduling Priiority  작업의 예약 우선순위
- NI : Nice value 우선순위에 영향을 주는 값을 음수이면 우선순위가 높고 양수라면 낮음
- VIRT : Swapped size(kb). 가상메모리(virtual memory) 크기, 프로세스가 사용하고 있는 가상메모리 용량(SWAP+RES)
- RES  : Resident Size(kb) 상주메모(resident memory)크기, 프로세스가 실제로 사용하고 있는 물리메모리 용량 (CODE + DATA)
- SHR : Shared Mem size(kb) 공유메모리(shared memory)크기, 다른 프로세스와 공유하고 있는 공유 메모리 용량
- S : Process Status 프로세스 상태
    - R : Running
    - S : Sleeping
    - I : Idle
    - D : uninterruptable Sleep 무중단 sleeep 상태
    - T : 작업 제어 신호에 의해 중지됨
    - t : Trace 중 디버거에 의해 중지됨
    - Z : Zombie
- %CPU : CPU 사용량
- %MEM : Memory usage(RES) 메모리 사용량. 현재 사용한 실제 메모리 양
- TIME+ : CPU TIME. 프로세스가 사용한 CPU 시간, 작업이 시작된 이후 사용한 총 CPU 시간
누적 모드 On - 각 프로세스는 자신과 죽은 자식 프로세스가 사용한 CPU 시간과 함께 나열.
S : 누적 모드 변경 문자열
- COMMAND : 명령어 이름, 명령어 라인. 작업을 시작할 때 사용되는 명령어 라인 혹은 프로그램의 이름 표시
C : 명령어 랑니 또는 프로그램 이름 표시 변경 문자열
명령어 라인 표시로 변경될 경우 명령어 라인이 없는 프로세스(예: 커널 스레드)는 괄호 안에 프로그램 이름만 표시
대부분의 열과 달리 COMMAND 필드는 고정너비가 아님
표시될 때, 다른 가변 너비 열과 함께 나머지 모든 화면 너비가 할당됨(~512자)

## top 명령어 커맨드

- 기본 명령어로 3초마다 출력 갱신
    - $ top
- 화면 업데이트 시간 변경
    - $ top -d [n초]
- 프로세스 종료
    1. top 명령어 화면 실행
    2. k 키 입력 :  특정 프로세스 종료 가능 K 키를 누르면 특정 프로세스를 종료할 수 있다.
    3.  PID를 입력하면 isgnal 을 입력하라고 표시됨.
    - 이때 9 (skgkill)시그널 혹은 15(sigterm)시그널을 주어 프로세스를 종료할 수 있음
- 명령어 출력 결과 종료
    1. M : 메모리 사용량 기준으로 정렬
    2. P : CPU 사용량 기준으로 정렬
    3. N : 프로세스 ID 별로 정렬
    4. T : 실행시간 기준으로 정렬
- Task/Threads 모드 변경
    1. top 명령 실행
    2. H 입력 : Tasks ↔ Threads 모드 전환
- Command 필드 모드 변경
    1. top 명령 실행
    2. c 로 Command 필드에 프로그램 이름 ↔ 명령어 모드 전환
- CPU 및 Memory 출력 모드 변경
    1. top 명령 실행
    2. 1 입력 → 코어별 CPU 사용률 / VM일 경우 vCPU
    3. t 및 m 반복 입력 시 출력 모드 변경 확인 가능
    t : CPU / m : memory
- top 출력 결과 저장
    1. top 명령 실행
    2. A 입력
    3. W 입력 → 정해진 경로 저장

## 정렬하기

- P : CPU 사용량으로 정렬
- M : 메모리 사용량으로 정렬
- N : PID 순으로 정렬
- T : Running Time 으로 정렬
- R : 오름차순과 내림차순 토글 변경

## 쓰레드 기준으로 보여주기

- H : 프로세스가 아닌 쓰레드 기준으로 출력
- h :  help 창으로 연결.

- I : Irix/Solaris 모드 변경
- V : 트리구조 뷰 모드 변경
- v : 자식 프로세스 축소 변경

## 정보 바로 업데이트

- top 명령어는 정보를 실시간으로 보여줌. 딜레이 있을 수 있ㅇ므
- 이때 스페이스바를 누르면 바로 업데이트
- 처음 top 명렬어 실행 시 top-d(초 단위) 형식으로 업데이트 시간 변경 가능

## 나가기

- q : top 명령어 화면에서 나감

# PS

- ps : 사용자와 관련된 프로세스만 출력
- USER(BSD) UID(System V) : 프로세스 소유자의 이름
- PID : 프로세스 ID
- PPID : 부모 프로세스의 PID
- %CPU : CPU 사용 비율의 추정치 (BSD)
- %MEM : Memory 사용 비율의 추정치(BSD)
- VS2 : K 단위 또는 페이지 단위의 가상 메모리 사용량
- RSS : 실제 메모리 사용량
- TTY : 프로세스와 연결된 터미널
콘솔접속시 ‘tty숫자’형태로 표시. 원격이나 에뮬레이터 접속 시 ‘pts/숫자’형태로 표시
- S(System V) STAT(BBSD) : 현재 프로세스의 상태 코드
- TIME : 총 CPU 사용 시간
- COMMAND : 프로세스의 실행 명령
- STIME : 프로세스가 시작된 시간 혹은 날짜
- C(System V) CP(BSD) : 짧은 기간 동안의 CPU 사용률
- F  : 플래그
- PRI : 실제 실행 우선순위
- NI : Nice 우선순위 번호

## PS 옵션

- -A : 모든 프로세스 출력
- a(RSD) : 터미널과 연관된 프로세스를 출력, x 옵션과 같이 사용하여 모든 프로세스를 출력 시 사용
- -a : 세션 리더를 제외하고 테몬 프로세스처럼 터미널에 종속되지 않은 모든 프로세스를 출력
- e : 프로세스에 관련된 환경 변수 정보 출력
- -e : 모든 프로세스 출력
- f : 프로세스 간 상속관계를 트리형식으로 출력
- -f : 출력을 풀 포맷으로 표기(유닉스 스타일) UID, PID, PPID 등이 함께 표시
- l : 프로세스의 정보를 길게 보여줌
- -l(System V) l(BSD) : 출력을 긴 포맷을 표기. 프로세스의 정보를 길게 보여주는 옵션으로 우선순위와 관련된 PRI 값과 NI값을 확인
- -o : 출력 포맷 지정
- -M : 64비트 프로세스들 출력
- -m : 프로세스 뿐만 아니라 커널 스레드도 출력
- p : 저장한 프로세스 출력
- -p : 특정 PID를 지정하여 출력
- -r : 현재 실행 중인 프로세스 출력
- u(RSD) : 프로세스의 소유자를 기준으로 출력
- -u [사용자] : 특정 사용자의 프로세스 정보를 출력, 사용자를 지정하지 않는다면 현재 사용자 기준으로 출력
- X(BSD) : 데몬 프로세스처럼 터미널에 종속되지 않은 프로세스를 출력
- x : 터미널에 종속되지 않는 프로세스 출력
- -x : 로그인 상태에 있는 동안 아직 완료되지 않은 프로세스를 출력.

## 사용 예

ps [옵션]

- System V
    - ps -ef | grep [키워드]
        - grep 명령어 이용해 특정 키워드 가진 행 출력
        - -ef 옵션은 동작 중인 모든 프로세스를 소유자 정보와 함께 풀 포맷으로 출력하는 명령어
        e : 모든 프로세스 표시
        f : 더 많은 프로세스 정보 표시
        
        ```cpp
        ps -ef | grep [프로세스명]
        ```
        
    - ps -ef | more
    ps -ef와 같은 많은 프로세스의 목록을 출력할 때는 more 명령어를 사용하면 좀 더 가독성이 좋아짐
    more 명령어 사용 시 페이지 단위로 목록 출력
- BSD
    - aux는 동작 중인 모든 프로세스를 소유자 정보와 함께 다양한 정보 출력 옵션
    
    ```cpp
    ps aux | grep [프로세스명]
    ```
    
- ps -el
    - 프로세스의 정보가 긴 포맷으로 출력. -ef 옵션에서 보지 못한 F, S, PRI, NI 등 다양한 정보 출력
- ps -t [tty명]
    - 특정 TTY에서 실행되는 프로세스 출력
- ps -p [프로세스 번호]
    - 특정 프로세스 번호 이용해 해당 프로세스 번호 출력
- ps -u [사용자명]
    - 특정 사용자의 프로세스 정보 출력
- ps -o[프로세스 항목]
    - 특정 프로세스 항목 확인

프로세스를 트리 형태로 출력(pstree)

```jsx
$ pstree [옵션]
```

- -a : 프로세스 명령줄 인자 출력
- -h : 현재 프로세스와 부모 프로세스를 강조 표시
- -n : 프로세스 이름 대신에 PID순으로정렬
- -p : PID와 함께 출력
- -s : 특정 프로세스의 부모 프로세스를 출력

실시간 프로세스 출력 (top)

- -n : 지정한 숫자만큼 화면 출력을 갱신한 후 명령
- -u : 지정한 사용자의 프로세스를 모니터링
- -b : 출력결과를 파일이나 다른 프로그램으로 전달
- -d : 화면갱신주기를 초단위로 설정
- -p : 지정한 PID프로세스를 모니터링
- 

# jobs

[리눅스 jobs 명령어 사용법](https://www.lainyzine.com/ko/article/linux-jobs-command-usage/)

백그라운드에서 실행된 프로그램

```jsx
jobs [OPTIONS] [JOB]
```

상태

- Running : 작업 진행중
- Done : 작업이 완료되어 0 반환
- Done(code) : 작업이 종료되고 0아닌 코드 반환
- Stopped : 작업 일시 중단
- Stopped(SIGTSTP) : SIGTSTP 시그널이 작업 일시 중단
- Stopped(SIGSTOP) : SIGSTOP 시그널이 작업 일시 중단
- Stopped(SIGTTIN) : SIGTTIN 시그널이 작업 일시 중단
- Stopped(SIGTTOU) : SIGTTOU 시그널이 작업 일시 중단

옵션

- -l : 프로세스 ID와 함께 잡 목록 출력
- -n : 마지막 알림 이후 변경된 잡만 출력
- -p : 잡의 프로세스 ID만 출력
- -r : 실행 중인 잡만 출력
- -s : 중지된 잡만 출력
- command : 지정한 명령어 실행

# kill

프로세스 종료

이전에 Process ID 확인

```jsx
//프로세스 목록 확인
$ ps
//프로세스 목록 자세히 확인
$ ps u
//프로세스 목록 배열 및 시스템 자원 사용률 확인
$ ps aux
```

- ps -ef
    - PID : 프로세스 ID
    - PPID : 부모프로세스 ID

```jsx
//프로세스 죽이기
$ kill 프로세스번호
$ kill %작업번호
```

옵션

- -9 : 강제종료(kill)
    - 리눅스 커널이 프로세스를 강제종료
- -15 : 정상 종료(terminating)
    - TERM 시그널(default)
    자신이 하던 작업을 모두 안전하게 종료하는 절차로 프로세스 종료
    메모리상에 있는 데이터와 각종 설정/환경 파일을 안전하게 저장 후 프로세스 종료
